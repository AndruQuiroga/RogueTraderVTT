{{!-- Talents Panel - Compact Table View with Filtering --}}
<div class="rt-panel rt-panel-talents-table">
    <div class="rt-panel-header">
        <span class="rt-panel-title">
            <i class="fas fa-star"></i> Talents
        </span>
    </div>
    
    {{!-- Filter Controls --}}
    <div class="rt-talents-filters">
        <input type="text" 
               class="rt-filter-search" 
               name="talents-search" 
               placeholder="Search talents..." 
               data-action="filterTalents"
               value="{{talentsFilter.search}}" />
        
        <select class="rt-filter-select" name="talents-category" data-action="filterTalents">
            <option value="">All Categories</option>
            {{#each talentCategories as |cat|}}
            <option value="{{cat}}" {{#if (eq ../talentsFilter.category cat)}}selected{{/if}}>{{cat}}</option>
            {{/each}}
        </select>

        {{#if (or talentsFilter.search talentsFilter.category talentsFilter.tier)}}
        <button type="button" class="rt-filter-clear" data-action="clearTalentsFilter" title="Clear Filters">
            <i class="fas fa-times"></i>
        </button>
        {{/if}}
    </div>
    
    <div class="rt-panel-body">
        <div class="rt-talents-table" data-drop-zone="talents" data-accepts="talent">
            {{#each talents as |talent|}}
            <div class="rt-talent-row item-drag" data-item-id="{{talent.id}}" draggable="true">
                <img class="rt-row-icon" src="{{talent.img}}" alt="{{talent.name}}" />
                
                <div class="rt-row-main">
                    <button type="button" class="rt-row-name" data-action="itemEdit" data-item-id="{{talent.id}}" title="Click to open item sheet">
                        {{talent.fullName}}
                        {{#if talent.flags.rogue-trader.autoGranted}}
                        <span class="rt-granted-badge" title="Granted by {{talent.flags.rogue-trader.grantedBy}}">
                            <i class="fas fa-gift"></i>
                        </span>
                        {{/if}}
                    </button>
                    
                    <div class="rt-row-meta">
                        <span class="rt-meta-item">
                            <i class="fas {{talentIcon talent.system.category}}"></i> {{talent.categoryLabel}}
                        </span>
                        {{#if talent.system.tier}}
                        <span class="rt-meta-item">
                            Tier {{talent.system.tier}}
                        </span>
                        {{/if}}
                        {{#if talent.system.stackable}}
                        <span class="rt-meta-item rt-meta-rank">
                            Rank {{talent.system.rank}}
                        </span>
                        {{/if}}
                        {{#if talent.system.hasGrants}}
                        <span class="rt-meta-item rt-meta-grants" title="This talent grants other abilities">
                            <i class="fas fa-gift"></i> Grants
                        </span>
                        {{/if}}
                    </div>
                </div>
                
                <div class="rt-row-actions">
                    <button type="button" class="rt-talent-action-btn {{#if talent.isFavorite}}active{{/if}}"
                            data-action="toggleFavoriteTalent" data-item-id="{{talent.id}}"
                            title="{{#if talent.isFavorite}}Remove from favorites{{else}}Add to favorites{{/if}}">
                        <i class="{{#if talent.isFavorite}}fas{{else}}far{{/if}} fa-star"></i>
                    </button>
                    <button type="button" class="rt-talent-action-btn" data-action="itemVocalize" data-item-id="{{talent.id}}" title="Send to Chat">
                        <i class="fas fa-comment"></i>
                    </button>
                    <button type="button" class="rt-talent-action-btn" data-action="toggleItemPreview" data-item-id="{{talent.id}}" title="Quick Preview">
                        <i class="fas fa-chevron-up"></i>
                    </button>
                </div>
            </div>
            <!-- Item preview card container (populated by ItemPreviewMixin) -->
            <div id="item-preview-{{talent.id}}" class="rt-item-preview-container" style="display: none;"></div>
            {{/each}}
        </div>
        
        <div class="rt-dropzone {{#if talentsCount}}rt-dropzone--compact{{/if}}" data-action="itemCreate" data-type="talent">
            <i class="fas fa-star rt-dropzone-icon"></i>
            <span class="rt-dropzone-text">{{#if talentsCount}}Drop to add{{else}}Drop Talent or Click to Create{{/if}}</span>
        </div>
    </div>
</div>
