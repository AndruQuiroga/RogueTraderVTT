{{!-- Equipment Slots Panel - Visual Equipment Loadout --}}
{{!-- Interactive slot-based equipment management --}}

<div class="rt-panel rt-equipment-slots-panel">
    <div class="rt-panel-header">
        <span class="rt-panel-title"><i class="fas fa-user-gear"></i> Equipment Loadout</span>
        <div class="rt-panel-controls">
            <button 
                type="button" 
                class="rt-btn rt-btn--icon rt-btn--secondary" 
                data-action="toggleSlotView"
                title="{{#if (eq equipmentSlots.viewMode 'slots')}}Switch to List View{{else}}Switch to Slots View{{/if}}">
                <i class="fa-solid {{#if (eq equipmentSlots.viewMode 'slots')}}fa-list{{else}}fa-grid-2{{/if}}"></i>
            </button>
        </div>
    </div>
    
    {{#if (eq equipmentSlots.viewMode 'slots')}}
    <div class="rt-panel-body rt-equipment-slots-body">
        
        {{!-- WEAPONS GROUP --}}
        <div class="rt-slot-group rt-slot-group--weapons">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-sword"></i>
                {{equipmentSlots.slotGroups.weapons.label}}
            </h3>
            <div class="rt-slots-grid rt-slots-grid--weapons">
                {{#each equipmentSlots.slotGroups.weapons.slots as |slot|}}
                    {{> systems/rogue-trader/templates/actor/panel/partials/equipment-slot.hbs slot=slot}}
                {{/each}}
            </div>
        </div>

        {{!-- ARMOUR GROUP --}}
        <div class="rt-slot-group rt-slot-group--armour">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-shield"></i>
                {{equipmentSlots.slotGroups.armour.label}}
            </h3>
            <div class="rt-slots-grid rt-slots-grid--armour">
                {{#each equipmentSlots.slotGroups.armour.slots as |slot|}}
                    {{> systems/rogue-trader/templates/actor/panel/partials/equipment-slot.hbs slot=slot showAP=true}}
                {{/each}}
            </div>
        </div>

        {{!-- SPECIAL EQUIPMENT GROUP --}}
        <div class="rt-slot-group rt-slot-group--special">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-bolt"></i>
                {{equipmentSlots.slotGroups.special.label}}
            </h3>
            <div class="rt-slots-grid rt-slots-grid--special">
                {{#each equipmentSlots.slotGroups.special.slots as |slot|}}
                    {{> systems/rogue-trader/templates/actor/panel/partials/equipment-slot.hbs slot=slot}}
                {{/each}}
            </div>
        </div>

        {{!-- UTILITY BELT GROUP --}}
        <div class="rt-slot-group rt-slot-group--utility">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-toolbox"></i>
                {{equipmentSlots.slotGroups.utility.label}}
            </h3>
            <div class="rt-slots-grid rt-slots-grid--utility">
                {{#each equipmentSlots.slotGroups.utility.slots as |slot|}}
                    {{> systems/rogue-trader/templates/actor/panel/partials/equipment-slot.hbs slot=slot compact=true}}
                {{/each}}
            </div>
        </div>

        {{!-- GRENADES GROUP --}}
        <div class="rt-slot-group rt-slot-group--grenades">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-bomb"></i>
                {{equipmentSlots.slotGroups.grenades.label}}
            </h3>
            <div class="rt-slots-grid rt-slots-grid--grenades">
                {{#each equipmentSlots.slotGroups.grenades.slots as |slot|}}
                    {{> systems/rogue-trader/templates/actor/panel/partials/equipment-slot.hbs slot=slot compact=true}}
                {{/each}}
            </div>
        </div>

        {{!-- UNASSIGNED EQUIPPED ITEMS --}}
        {{#if equipmentSlots.unassignedEquipped.length}}
        <div class="rt-slot-group rt-slot-group--overflow">
            <h3 class="rt-slot-group-title">
                <i class="fa-solid fa-ellipsis"></i>
                Other Equipped Items
            </h3>
            <div class="rt-overflow-items">
                {{#each equipmentSlots.unassignedEquipped as |item|}}
                    <div class="rt-overflow-item" data-item-id="{{item.id}}" draggable="true">
                        <img src="{{item.img}}" alt="{{item.name}}" class="rt-overflow-item-icon" />
                        <span class="rt-overflow-item-name">{{item.name}}</span>
                        <button 
                            type="button" 
                            class="rt-btn rt-btn--icon rt-btn--sm" 
                            data-action="toggleItemPreview" 
                            data-item-id="{{item.id}}"
                            title="Show details">
                            <i class="fa-solid fa-chevron-down"></i>
                        </button>
                    </div>
                {{/each}}
            </div>
        </div>
        {{/if}}

    </div>
    {{else}}
    {{!-- List view - use existing equipment panels --}}
    <div class="rt-panel-body">
        <p class="rt-info-text">
            <i class="fa-solid fa-info-circle"></i>
            Switch to Slots View for visual equipment management.
        </p>
    </div>
    {{/if}}
</div>
