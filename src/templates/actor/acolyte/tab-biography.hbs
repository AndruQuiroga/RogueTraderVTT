{{!-- Acolyte Sheet Biography Tab --}}
{{!-- This part renders the Biography tab content with identity, origin path, and notes --}}
<section class="tab {{#if tab.active}}active{{/if}} {{ tab.cssClass }}" data-tab="{{ tab.id }}" data-group="{{ tab.group }}">
<div class="rt-bio-grid">
    {{!-- Left Column: Identity & Origin --}}
    <div class="rt-bio-col">
        {{!-- Identity Panel --}}
        <div class="rt-panel">
            <div class="rt-panel-header">
                <span class="rt-panel-title"><i class="fas fa-user"></i> Identity</span>
            </div>
            <div class="rt-panel-body">
                <div class="rt-identity-grid">
                    <div class="rt-field-row">
                        <label class="rt-field-label">Gender</label>
                        <input type="text" class="rt-field-input" name="system.bio.gender" value="{{system.bio.gender}}" />
                    </div>
                    <div class="rt-field-row">
                        <label class="rt-field-label">Age</label>
                        <input type="text" class="rt-field-input" name="system.bio.age" value="{{system.bio.age}}" />
                    </div>
                    <div class="rt-field-row">
                        <label class="rt-field-label">Build</label>
                        <input type="text" class="rt-field-input" name="system.bio.build" value="{{system.bio.build}}" />
                    </div>
                    <div class="rt-field-row">
                        <label class="rt-field-label">Complexion</label>
                        <input type="text" class="rt-field-input" name="system.bio.complexion" value="{{system.bio.complexion}}" />
                    </div>
                    <div class="rt-field-row">
                        <label class="rt-field-label">Hair</label>
                        <input type="text" class="rt-field-input" name="system.bio.hair" value="{{system.bio.hair}}" />
                    </div>
                    <div class="rt-field-row">
                        <label class="rt-field-label">Eyes</label>
                        <input type="text" class="rt-field-input" name="system.bio.eyes" value="{{system.bio.eyes}}" />
                    </div>
                </div>
            </div>
        </div>
        
        {{!-- Origin Path Panel - Modern Sleek Design --}}
        <div class="rt-panel rt-panel--bio rt-origin-panel-modern" data-panel-id="origin-path">
            <div class="rt-panel-header">
                <div class="rt-origin-header-left">
                    <i class="fas fa-route"></i>
                    <span class="rt-panel-title">Origin Path</span>
                    <div class="rt-origin-progress-badge {{#if originPathSummary.isComplete}}rt-complete{{/if}}">
                        <span class="rt-progress-text">{{originPathSummary.completedSteps}}/{{originPathSummary.totalSteps}}</span>
                        {{#if originPathSummary.isComplete}}
                            <i class="fas fa-check-circle"></i>
                        {{/if}}
                    </div>
                </div>
                <button type="button" class="rt-btn-icon rt-btn-icon--primary" data-action="openOriginPathBuilder" data-tooltip="Build Path">
                    <i class="fas fa-diagram-project"></i>
                </button>
            </div>
            <div class="rt-panel-body">
                {{!-- Visual Step Indicators --}}
                <div class="rt-origin-steps-visual">
                    {{#each originPathSteps as |step|}}
                    <div class="rt-origin-step-node {{#if step.item}}rt-filled{{else}}rt-empty{{/if}}" 
                         data-step="{{step.key}}"
                         {{#if step.item}}data-action="itemEdit" data-item-id="{{step.item._id}}"{{/if}}
                         data-tooltip="{{step.label}}{{#if step.item}}: {{step.item.name}}{{/if}}">
                        <div class="rt-step-circle">
                            {{#if step.item}}
                                <img src="{{step.item.img}}" alt="{{step.item.name}}" class="rt-step-img" />
                            {{else}}
                                <i class="fas {{step.icon}}"></i>
                            {{/if}}
                        </div>
                        <span class="rt-step-label">{{step.shortLabel}}</span>
                    </div>
                    {{#unless @last}}
                        <div class="rt-step-connector {{#if step.item}}rt-active{{/if}}"></div>
                    {{/unless}}
                    {{/each}}
                </div>

                {{!-- Selected Origins List --}}
                {{#if originPathSummary.completedSteps}}
                <div class="rt-origin-selections-modern">
                    {{#each originPathSteps as |step|}}
                    {{#if step.item}}
                    <div class="rt-origin-selection-card" data-item-id="{{step.item._id}}">
                        <div class="rt-selection-icon">
                            <img src="{{step.item.img}}" alt="{{step.item.name}}" />
                        </div>
                        <div class="rt-selection-content">
                            <span class="rt-selection-step-label">{{step.label}}</span>
                            <span class="rt-selection-name" data-action="itemEdit" data-item-id="{{step.item._id}}">{{step.item.name}}</span>
                        </div>
                        <button type="button" class="rt-btn-icon rt-btn-icon--delete" data-action="itemDelete" data-item-id="{{step.item._id}}" data-tooltip="Remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    {{/if}}
                    {{/each}}
                </div>
                {{/if}}

                {{!-- Accumulated Bonuses (Collapsible - Start Collapsed) --}}
                {{#if originPathSummary.isComplete}}
                <div class="rt-origin-bonuses-modern collapsed" data-panel-id="origin-bonuses" data-collapsed="true">
                    <button type="button" class="rt-bonuses-toggle" data-action="togglePanel" data-panel-id="origin-bonuses">
                        <i class="fas fa-gift"></i>
                        <span>Accumulated Bonuses</span>
                        <i class="fas fa-chevron-down rt-toggle-icon"></i>
                    </button>
                    
                    <div class="rt-bonuses-content">
                        {{!-- Characteristics --}}
                        {{#if originPathSummary.characteristics.length}}
                        <div class="rt-bonus-group">
                            <span class="rt-bonus-category-label">
                                <i class="fas fa-chart-bar"></i>
                                Characteristics
                            </span>
                            <div class="rt-bonus-chips">
                                {{#each originPathSummary.characteristics}}
                                <span class="rt-char-chip {{#if positive}}rt-positive{{else}}rt-negative{{/if}}">
                                    <span class="rt-chip-stat">{{short}}</span>
                                    <span class="rt-chip-value">{{#if positive}}+{{/if}}{{value}}</span>
                                </span>
                                {{/each}}
                            </div>
                        </div>
                        {{/if}}
                        
                        {{!-- Skills --}}
                        {{#if originPathSummary.skills.length}}
                        <div class="rt-bonus-group">
                            <span class="rt-bonus-category-label">
                                <i class="fas fa-book"></i>
                                Skills
                            </span>
                            <div class="rt-bonus-tags">
                                {{#each originPathSummary.skills}}
                                <span class="rt-bonus-tag rt-tag-skill">{{this}}</span>
                                {{/each}}
                            </div>
                        </div>
                        {{/if}}
                        
                        {{!-- Talents --}}
                        {{#if originPathSummary.talents.length}}
                        <div class="rt-bonus-group">
                            <span class="rt-bonus-category-label">
                                <i class="fas fa-star"></i>
                                Talents
                            </span>
                            <div class="rt-bonus-tags">
                                {{#each originPathSummary.talents}}
                                <span class="rt-bonus-tag rt-tag-talent">{{this}}</span>
                                {{/each}}
                            </div>
                        </div>
                        {{/if}}
                        
                        {{!-- Traits --}}
                        {{#if originPathSummary.traits.length}}
                        <div class="rt-bonus-group">
                            <span class="rt-bonus-category-label">
                                <i class="fas fa-dna"></i>
                                Traits
                            </span>
                            <div class="rt-bonus-tags">
                                {{#each originPathSummary.traits}}
                                <span class="rt-bonus-tag rt-tag-trait">{{this}}</span>
                                {{/each}}
                            </div>
                        </div>
                        {{/if}}
                    </div>
                </div>
                {{/if}}
            </div>
        </div>
        
        {{!-- Connections Panel --}}
        <div class="rt-panel">
            <div class="rt-panel-header">
                <span class="rt-panel-title"><i class="fas fa-users"></i> Connections</span>
            </div>
            <div class="rt-panel-body">
                <div class="rt-connections-section">
                    <div class="rt-affliction-header">
                        <span>Peers</span>
                        <button type="button" class="rt-add-btn" data-action="itemCreate" data-type="peer"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="rt-affliction-list">
                        {{#each actor.items as |item|}}
                            {{#if item.isPeer}}
                            <div class="rt-affliction-row" data-item-id="{{item.id}}">
                                <span class="rt-affliction-name" data-action="itemEdit" data-item-id="{{item.id}}">{{item.name}}</span>
                                <span class="rt-connection-bonus">+{{item.system.modifier}}</span>
                                <button type="button" class="rt-affliction-del" data-action="itemDelete" data-item-id="{{item.id}}"><i class="fas fa-times"></i></button>
                            </div>
                            {{/if}}
                        {{/each}}
                    </div>
                </div>
                <div class="rt-connections-section">
                    <div class="rt-affliction-header">
                        <span>Enemies</span>
                        <button type="button" class="rt-add-btn" data-action="itemCreate" data-type="enemy"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="rt-affliction-list">
                        {{#each actor.items as |item|}}
                            {{#if item.isEnemy}}
                            <div class="rt-affliction-row" data-item-id="{{item.id}}">
                                <span class="rt-affliction-name" data-action="itemEdit" data-item-id="{{item.id}}">{{item.name}}</span>
                                <span class="rt-connection-penalty">{{item.system.modifier}}</span>
                                <button type="button" class="rt-affliction-del" data-action="itemDelete" data-item-id="{{item.id}}"><i class="fas fa-times"></i></button>
                            </div>
                            {{/if}}
                        {{/each}}
                    </div>
                </div>
            </div>
        </div>
    </div>
        
        {{!-- Right Column: Journal/Notes --}}
        <div class="rt-bio-col">
            {{!-- Experience Panel --}}
            {{> systems/rogue-trader/templates/actor/panel/experience-panel-v2.hbs}}
            
            {{!-- Character Notes / Journal --}}
            <div class="rt-panel rt-panel-journal">
                <div class="rt-panel-header">
                    <span class="rt-panel-title"><i class="fas fa-book-open"></i> Character Journal</span>
                </div>
                <div class="rt-panel-body rt-journal-body">
                    <div class="rt-journal-section">
                        <label class="rt-field-label">Personality & Quirks</label>
                        <textarea class="rt-textarea" name="system.bio.quirks" rows="2" placeholder="Distinctive habits, mannerisms, beliefs...">{{system.bio.quirks}}</textarea>
                    </div>
                    <div class="rt-journal-section">
                        <label class="rt-field-label">Superstitions & Rituals</label>
                        <textarea class="rt-textarea" name="system.bio.superstition" rows="2" placeholder="Personal beliefs and observances...">{{system.bio.superstition}}</textarea>
                    </div>
                    <div class="rt-journal-section">
                        <label class="rt-field-label">Treasured Mementos</label>
                        <textarea class="rt-textarea" name="system.bio.mementos" rows="2" placeholder="Important possessions and keepsakes...">{{system.bio.mementos}}</textarea>
                    </div>
                    <div class="rt-journal-section rt-journal-notes">
                        <label class="rt-field-label">Background & Notes</label>
                        {{#if editable}}
                        <prose-mirror name="system.bio.notes" 
                                      value="{{biography.source.notes}}" 
                                      document-uuid="{{actor.uuid}}"
                                      class="rt-prose-editor"
                                      compact>
                            {{{biography.enriched.notes}}}
                        </prose-mirror>
                        {{else}}
                        <div class="rt-prose-content editor-content">
                            {{{biography.enriched.notes}}}
                        </div>
                        {{/if}}
                    </div>
                    {{> systems/rogue-trader/templates/actor/panel/journal-panel.hbs includePanel=false}}
                </div>
            </div>
        </div>
    </div>
</div>
</section>
